1
00:00:12,305 --> 00:00:19,340
Перейдем к оцениванию предельных эффектов.

2
00:00:19,340 --> 00:00:20,690
Тут все просто.

3
00:00:20,690 --> 00:00:26,096
В R уже есть готовая команда для
оценивания предельных эффектов,

4
00:00:26,096 --> 00:00:28,140
надо только указать какие,

5
00:00:28,140 --> 00:00:31,962
в каком смысле средние предельные
эффекты мы имеем в виду.

6
00:00:31,962 --> 00:00:36,927
Если мы просто напишем
maBina(m_logit) и нажмем Ctrl+Enter,

7
00:00:36,927 --> 00:00:43,530
то мы получим предельные эффекты для
среднестатистического пассажира Титаника.

8
00:00:43,530 --> 00:00:49,223
То есть, это означает, что у него будет
средний возраст, это будет некий индивид

9
00:00:49,223 --> 00:00:53,496
среднего пола на сколько-то процентов
мужчина, на сколько-то процентов женщина,

10
00:00:53,496 --> 00:00:58,088
и вот для такого среднестатистического
индивида мы можем сказать, что увеличение

11
00:00:58,088 --> 00:01:04,606
возраста на один год снижает
вероятность выжить на 0,008.

12
00:01:04,606 --> 00:01:09,100
Если же мы хотим посчитать средний эффект,

13
00:01:09,100 --> 00:01:14,568
усреднить его по всем пассажирам Титаника,
то мы должны указать немножко

14
00:01:14,568 --> 00:01:19,508
другую опцию maBina(m_logit) и здесь

15
00:01:19,508 --> 00:01:24,690
указать x.mean равняется FALSE.

16
00:01:24,690 --> 00:01:31,597
Соответственно, вот этот предельный
эффект он рассчитывается по-другому.

17
00:01:31,597 --> 00:01:36,960
Считается насколько увеличение возраста
на 1 год для каждого пассажира,

18
00:01:36,960 --> 00:01:40,590
насколько это увеличит или
уменьшит его вероятность выжить,

19
00:01:40,590 --> 00:01:44,160
а затем берется среднее
арифметическое по всем пассажирам.

20
00:01:44,160 --> 00:01:49,396
Соответственно, при
такой постановке задачи,

21
00:01:49,396 --> 00:01:53,615
если мы каждому пассажиру
увеличим возраст на 1 год,

22
00:01:53,615 --> 00:01:57,906
а потом усредним вероятность
выжить по всем пассажирам,

23
00:01:57,906 --> 00:02:01,280
то получится, что она падает на 0,005.

24
00:02:01,280 --> 00:02:04,058
Проинтерпретируем предельные эффекты.

25
00:02:04,058 --> 00:02:06,500
По умолчанию R выдает предельные эффекты,

26
00:02:06,500 --> 00:02:09,438
рассчитанные для
среднестатистического наблюдения.

27
00:02:09,438 --> 00:02:14,463
Ну, например, предельный эффект

28
00:02:14,463 --> 00:02:20,631
при увеличении возраста на единичку,
предельный эффект на вероятность того,

29
00:02:20,631 --> 00:02:25,335
что пассажир выживет, то есть на
вероятность того, что y равен единичке,

30
00:02:25,335 --> 00:02:29,814
оцененный при средних значениях
регрессоров, давайте я поставлю тут x

31
00:02:29,814 --> 00:02:35,780
среднее, этот предельный
эффект равен –0,008.

32
00:02:35,780 --> 00:02:41,480
Это означает,
что для среднестатистического пассажира,

33
00:02:41,480 --> 00:02:44,379
надо еще понять кто такой
среднестатистический пассажир,

34
00:02:44,379 --> 00:02:49,495
но для среднестатистического пассажира
при увеличении возраста на единичку

35
00:02:49,495 --> 00:02:54,830
вероятность падает на –0,008,
на восемь тысячных,

36
00:02:54,830 --> 00:02:59,430
то есть примерно на один процентный
пункт падает вероятность выжить.

37
00:02:59,430 --> 00:03:02,223
Кто такой среднестатистический пассажир?

38
00:03:02,223 --> 00:03:06,734
Это пассажир, у которого средний возраст,
средний возраст,

39
00:03:06,734 --> 00:03:12,990
средний возраст равен по выборке 30-ти
годам, но более того, это средний

40
00:03:12,990 --> 00:03:17,757
пассажир, который средний, в том числе, по
таким дискретным характеристикам, как пол.

41
00:03:17,757 --> 00:03:22,130
Этот пассажир гипотетический на 36 %

42
00:03:22,130 --> 00:03:27,828
женщина и на 64 % мужчина.

43
00:03:27,828 --> 00:03:35,350
Этот среднестатистический пассажир
на 25 % едет первым классом,

44
00:03:35,350 --> 00:03:43,090
на 21 % вторым классом и
на 54 % третьим классом.

45
00:03:43,090 --> 00:03:48,679
И для такого среднестатистического
пассажира вот

46
00:03:48,679 --> 00:03:53,710
он эффект увеличения возраста
на 1 год на вероятность выжить.

47
00:03:53,710 --> 00:03:58,850
Сравним предельные эффекты
усредненные по всем пассажирам.

48
00:03:58,850 --> 00:04:04,271
То есть мы рассчитаем
предельный эффект вероятности,

49
00:04:04,271 --> 00:04:11,530
предельный эффект на вероятность выжить от
увеличения возраста для каждого пассажира,

50
00:04:11,530 --> 00:04:16,930
и после этого усредним по всем пассажирам.

51
00:04:16,930 --> 00:04:21,303
То есть мы рассчитываем эту величину
не для среднестатистического пассажира,

52
00:04:21,303 --> 00:04:26,128
а рассчитываем для каждого пассажира,
получаем n эффектов и считаем

53
00:04:26,128 --> 00:04:30,760
средний арифметический
эффект по этим n эффектам.

54
00:04:30,760 --> 00:04:35,015
И он, согласно результатам оценивания,

55
00:04:35,015 --> 00:04:40,370
равен –0,005.

56
00:04:40,370 --> 00:04:48,320
То есть, если я каждому пассажиру
увеличу гипотетически возраст на 1 год,

57
00:04:48,320 --> 00:04:53,026
то в среднем по всем
пассажирам вероятность

58
00:04:53,026 --> 00:04:57,515
выжить уменьшится на пять тысячных,

59
00:04:57,515 --> 00:05:01,490
то есть на половину процентного пункта.

60
00:05:01,490 --> 00:05:06,573
Для дискретных переменных R автоматически

61
00:05:06,573 --> 00:05:11,200
считает разницу вероятностей,
а не производную.

62
00:05:11,200 --> 00:05:17,168
То есть если рассмотреть коэффициент,
предельный эффект при переменной пол,

63
00:05:17,168 --> 00:05:22,694
то R автоматически считает следующую
разницу: вероятность того,

64
00:05:22,694 --> 00:05:27,530
что yi-тое равно единичке при условии,

65
00:05:27,530 --> 00:05:32,057
что dime-переменная пол равен единичке,

66
00:05:32,057 --> 00:05:35,684
то есть мужчина минус вероятность того,

67
00:05:35,684 --> 00:05:41,550
что yi-тое равно нулю при условии,
что этот пассажир женщина.

68
00:05:41,550 --> 00:05:46,734
При этом опять же эту

69
00:05:46,734 --> 00:05:51,799
разницу вероятностей можно
считать в двух вариантах.

70
00:05:51,799 --> 00:05:55,700
Один вариант — для
среднестатистического пассажира,

71
00:05:55,700 --> 00:05:59,860
для среднестатистического пассажира,

72
00:05:59,860 --> 00:06:05,690
который имеет возраст 30 лет, на 36 %
женщина и на 60 % мужчина и так далее,

73
00:06:05,690 --> 00:06:12,660
и усреднять по всем пассажирам,
усреднять по пассажирам.

74
00:06:12,660 --> 00:06:16,575
То есть посчитать эту разницу
для каждого пассажира,

75
00:06:16,575 --> 00:06:21,510
получить n чисел и взять по
ним среднее арифметическое.

76
00:06:21,510 --> 00:06:26,930
Ну в нашем случае эти два способа
подсчета дают один и тот же результат,

77
00:06:26,930 --> 00:06:32,130
и этот предельный эффект равен –0,55.

78
00:06:32,130 --> 00:06:37,532
То есть если сравнить двух пассажиров,
которые, ну, допустим,

79
00:06:37,532 --> 00:06:42,172
рассмотрим двух среднестатистических
пассажиров, один из которых мужчина,

80
00:06:42,172 --> 00:06:46,971
а другой женщина,
то разница в вероятности выжить у

81
00:06:46,971 --> 00:06:52,460
мужчины на 55 процентных пунктов ниже,
чем у женщины.

82
00:06:52,460 --> 00:06:57,251
Теперь сделаем вид, что мы не
знаем про логит и пробит модели и

83
00:06:57,251 --> 00:07:01,306
попробуем применить старый обычный
метод наименьших квадратов.

84
00:07:01,306 --> 00:07:02,895
Что произойдет в этом случае,

85
00:07:02,895 --> 00:07:07,370
если мы применим неподходящий
метод к данному набору данных?

86
00:07:07,370 --> 00:07:12,920
Я еще раз скажу, что его применять
некорректно, но надо всегда иметь в виду,

87
00:07:12,920 --> 00:07:17,154
что вы можете реализовать применить
даже тот метод оценивания на компьютере,

88
00:07:17,154 --> 00:07:19,103
который к этому набору данных не применим.

89
00:07:19,103 --> 00:07:22,700
Здесь надо всегда иметь в виду, что
компьютер какие-то результаты да выдаст,

90
00:07:22,700 --> 00:07:25,608
но вот интерпретировать
их надо будет осторожно.

91
00:07:25,608 --> 00:07:26,830
Давайте попробуем.

92
00:07:26,830 --> 00:07:32,860
Возьмем нашу формулу,
по которой мы оценивали логит модель.

93
00:07:32,860 --> 00:07:35,580
Так, вот она.

94
00:07:35,580 --> 00:07:40,610
И теперь вместо логит модели

95
00:07:40,610 --> 00:07:44,477
оценим обычный метод наименьших квадратов.

96
00:07:44,477 --> 00:07:48,770
Модель ols — это уже не обобщенная,
а просто линейная модель.

97
00:07:48,770 --> 00:07:51,454
И здесь еще нужно одно
маленькое изменение.

98
00:07:51,454 --> 00:07:56,080
Поскольку мы переменную survived
закодировали как факторную, а для метода

99
00:07:56,080 --> 00:08:01,190
наименьших квадратов она должна считаться
количественной, ну давайте скажем,

100
00:08:01,190 --> 00:08:07,080
чтобы компьютер трактовал ее как
количественную as.numeric(survived).

101
00:08:07,080 --> 00:08:14,114
Соответственно, мы оценили модель
методом наименьших квадратов,

102
00:08:14,114 --> 00:08:19,598
можем как всегда посмотреть
на значение коэффициентов,

103
00:08:19,598 --> 00:08:23,380
оценки, проверку гипотез.

104
00:08:23,380 --> 00:08:27,450
Давайте попробуем с помощью этой
модели предсказать вероятности,

105
00:08:27,450 --> 00:08:31,520
как мы предсказывали их
с помощью модели логит.

106
00:08:31,520 --> 00:08:37,070
Предсказанные вероятности
по модели ols predict,

107
00:08:37,070 --> 00:08:42,420
модель ols для набора данных newdata.

108
00:08:42,420 --> 00:08:48,940
А теперь посмотрим на сами
предсказанные вероятности.

109
00:08:48,940 --> 00:08:53,750
На первые несколько
предсказанных вероятностей.

110
00:08:53,750 --> 00:08:58,142
И мы видим,
что в этом случае модель для нашего

111
00:08:58,142 --> 00:09:02,991
набора данных newdata
прогнозирует вероятности 1,37,

112
00:09:02,991 --> 00:09:06,513
1,36, что явно не соответствует
действительности,

113
00:09:06,513 --> 00:09:09,920
поскольку вероятности должны
лежать в диапазоне от 0 до 1.

114
00:09:09,920 --> 00:09:15,190
Тем не менее, несмотря на такой
очевидный недостаток метода наименьших

115
00:09:15,190 --> 00:09:19,629
квадратов применительно к
прогнозированию бинарных переменных,

116
00:09:19,629 --> 00:09:24,845
тем не менее для средних наблюдений,
для среднестатистического индивида метод

117
00:09:24,845 --> 00:09:32,070
наименьших квадратов вполне может
дать адекватные результаты.

